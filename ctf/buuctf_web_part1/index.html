<!DOCTYPE html>
<html lang="en" dir="ltr" itemscope itemtype="http://schema.org/Article">

  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  <title>BUUCTF_WEB_part1</title>
  <meta name="author" content="" />
  <meta name="description"
        content="1.[BJDCTF2020]Easy MD5
0x0
一打开发现是一个查询页面，按F12，看到响应头Hint: select * from &#39;admin&#39; where password=md5($pass,true)初步以为是sql注入，试了一下（因为太菜&#43;懒，也没怎么试就去找wp了……）；发现md5($pass,true)是一个知识点来的，可以参考这篇大佬的文章：大佬文章
语法：..."/>


  <meta name="generator" content="Hugo 0.78.2" />

  
  <meta itemprop="name" content="BUUCTF_WEB_part1"/>
  <meta itemprop="description"
        content="1.[BJDCTF2020]Easy MD5
0x0
一打开发现是一个查询页面，按F12，看到响应头Hint: select * from &#39;admin&#39; where password=md5($pass,true)初步以为是sql注入，试了一下（因为太菜&#43;懒，也没怎么试就去找wp了……）；发现md5($pass,true)是一个知识点来的，可以参考这篇大佬的文章：大佬文章
语法：..."/>
  <meta itemprop="image"
        content=""/>

  
  <meta property="og:title" content="BUUCTF_WEB_part1"/>
  <meta property="og:type"
        content="article"/>
  <meta property="og:url" content="https://hzlhy.github.io/ctf/buuctf_web_part1/"/>
  <meta property="og:image"
        content=""/>
  <meta property="og:description"
        content="1.[BJDCTF2020]Easy MD5
0x0
一打开发现是一个查询页面，按F12，看到响应头Hint: select * from &#39;admin&#39; where password=md5($pass,true)初步以为是sql注入，试了一下（因为太菜&#43;懒，也没怎么试就去找wp了……）；发现md5($pass,true)是一个知识点来的，可以参考这篇大佬的文章：大佬文章
语法：..."/>
  <meta property="og:site_name" content="LHY&#39;s blogs"/>
  <meta property="article:published_time"
        content="2021-03-26T15:32:23&#43;08:00"/>
  <meta property="article:section" content="CTF"/>
  <meta property="article:tag" content="BUUCTF_WEB"/>

  
  
  <meta name="twitter:card" content="summary"/>
  <meta name="twitter:site"
        content=""/>
  <meta name="twitter:title" content="BUUCTF_WEB_part1"/>
  <meta name="twitter:description"
        content="1.[BJDCTF2020]Easy MD5
0x0
一打开发现是一个查询页面，按F12，看到响应头Hint: select * from &#39;admin&#39; where password=md5($pass,true)初步以为是sql注入，试了一下（因为太菜&#43;懒，也没怎么试就去找wp了……）；发现md5($pass,true)是一个知识点来的，可以参考这篇大佬的文章：大佬文章
语法：..."/>
  <meta name="twitter:creator"
        content=""/>
  <meta name="twitter:image:src"
        content=""/>

  

  
  <link rel="stylesheet" type="text/css" href="/css/capsule.min.css"/>
  
  

  
  </head>


  <body style="min-height:100vh;display:flex;flex-direction:column">

    <nav class="navbar has-shadow is-white"
     role="navigation" aria-label="main navigation">
  <div class="container">

    <div class="navbar-brand">
      <a class="navbar-item" href="/">
        <div class="title is-4">&nbsp;LHY&#39;s blogs</div>
      </a>

      
      <label role="button" class="navbar-burger has-text-dark"
             aria-label="menu" aria-expanded="false"
             for="navbar-burger-state">
             
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </label>
    </div>

    
    <input type="checkbox" id="navbar-burger-state"/>
                          

    <div class="navbar-menu">
      <div class="navbar-end">
      <a href="/about/"
         class="navbar-item
                ">Abouts</a>
      <a href="/ctf/"
         class="navbar-item
                ">CTFs</a>
      </div>
    </div>

  </div>
</nav>


    <section class="section" style="flex:1">

      
      <div class="container">
        <h1 class="title">BUUCTF_WEB_part1</h1>
        <p class="subtitle">Mar 26, 2021</p>

        

        
        <div class="content">
          <h2 id="1bjdctf2020easy-md5">1.[BJDCTF2020]Easy MD5</h2>
<h4 id="0x0">0x0</h4>
<p>一打开发现是一个查询页面，按F12，看到响应头<code>Hint: select * from 'admin' where password=md5($pass,true)</code>初步以为是sql注入，试了一下（因为太菜+懒，也没怎么试就去找wp了……）；发现<code>md5($pass,true)</code>是一个知识点来的，可以参考这篇大佬的文章：<a href="https://blog.csdn.net/March97/article/details/81222922">大佬文章</a></p>
<p>语法：</p>
<p>md5(string,raw)</p>
<table>
<thead>
<tr>
<th>参数</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td style="text-align:left">必需。需要计算的字符串。</td>
</tr>
<tr>
<td>raw</td>
<td style="text-align:left">可选。1.默认不写为FALSE。32位16进制的字符串；2.TRUE。16位原始二进制格式的字符串。</td>
</tr>
</tbody>
</table>
<blockquote>
<p>；content: ffifdyop</p>
<p>hex: 276f722736c95d99e921722cf9ed621c</p>
<p>raw: &lsquo;or'6\xc9]\x99\xe9!r,\xf9\xedb\x1c</p>
<p>string: &lsquo;or'6]!r,b</p>
</blockquote>
<p>注意：当raw为true时，这里所说的原始二进制并不是普通的二进制0，1，而是像上面表里raw那样的；</p>
<p>（部分字符会乱码）</p>
<p>题目中 <code>''or'6�]��!r,��b'</code>会返回true，是因为在MySQL里面，在用作布尔型判断时，以1开头的字符串会被当做整型数。要注意的是这种情况是必须要有单引号括起来的，如<code>password=‘xxx’ or ‘1xxxxxxxxx’</code>，不只是1开头，只要是数字开头都可以。</p>
<h4 id="0x1">0x1</h4>
<p>回到题目，照上面所说的，输入 <code>ffifdyop</code>提交查询出现一个新的页面，查看源码</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;!--</span>
$a <span style="color:#f92672">=</span> $GET[<span style="color:#e6db74">&#39;a&#39;</span>];
$b <span style="color:#f92672">=</span> $_GET[<span style="color:#e6db74">&#39;b&#39;</span>];

<span style="color:#66d9ef">if</span>($a <span style="color:#f92672">!=</span> $b <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">md5</span>($a) <span style="color:#f92672">==</span> <span style="color:#a6e22e">md5</span>($b)){
    <span style="color:#75715e">// wow, glzjin wants a girl friend.
</span><span style="color:#75715e"></span><span style="color:#f92672">--&gt;</span>
</code></pre></div><p><code>==</code>老朋友了，同时要使这两个的md5相等，这里抄了别人的wp，有两种方法：</p>
<blockquote>
<p>姿势一：</p>
<p>找出md5值都是0e开头的。原理是php里面做==时会把两边类型转为一样的，因为都是0e开头，php会认为它是科学计数法，恒为0。</p>
<p>eg：</p>
<p>QNKCDZO
s155964671a
s1091221200a</p>
<p>姿势二：</p>
<p>数组绕过。原理是md5等函数不能处理数组，导致函数返回NULL。两边均为NULL相等即可绕过</p>
<p>eg：</p>
<p>?a[]=1&amp;b[]=2</p>
</blockquote>
<h4 id="0x2">0x2</h4>
<p>绕过后，又到了一个新的页面，这次换成了<code>===</code>，第一种姿势已经不行了，但姿势二依然可以；</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"> <span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
<span style="color:#a6e22e">error_reporting</span>(<span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">include</span> <span style="color:#e6db74">&#34;flag.php&#34;</span>;

<span style="color:#a6e22e">highlight_file</span>(<span style="color:#66d9ef">__FILE__</span>);

<span style="color:#66d9ef">if</span>($_POST[<span style="color:#e6db74">&#39;param1&#39;</span>]<span style="color:#f92672">!==</span>$_POST[<span style="color:#e6db74">&#39;param2&#39;</span>]<span style="color:#f92672">&amp;&amp;</span><span style="color:#a6e22e">md5</span>($_POST[<span style="color:#e6db74">&#39;param1&#39;</span>])<span style="color:#f92672">===</span><span style="color:#a6e22e">md5</span>($_POST[<span style="color:#e6db74">&#39;param2&#39;</span>])){
    <span style="color:#66d9ef">echo</span> $flag;
} 
</code></pre></div><p>payload如下：<code>param1[]=1&amp;param2[]=2</code>，post过去即可</p>

        </div>

        

        
<br>
<div class="heading">Categories:</div>
<div class="field is-grouped is-grouped-multiline">
  <div class="control">
    <a href="/categories/ctf">
      <span class="tag">C T F</span>
    </a>
  </div>
</div>
<div class="heading">Tags:</div>
<div class="field is-grouped is-grouped-multiline">
  <div class="control">
    <a href="/tags/buuctf_web">
      <span class="tag">B U U C T F W E B</span>
    </a>
  </div>
</div>

      </div>

    </section>

    <section class="section">
      
      <div class="container">
  <div class="level">

    <div class="level-left">
      <div class="level-item">
        <p class="control has-addons">
          <a class="button" href="https://hzlhy.github.io/ctf/hugo_use/">
            <span class="icon is-small"><i class="fas fa-chevron-left"></i></span>
            <span class="is-hidden-touch is-hidden-desktop-only">
              Hugo_use
            </span>
            <span class="is-hidden-touch is-hidden-widescreen">
              Hugo_use
            </span>
            <span class="is-hidden-mobile is-hidden-desktop">
              Hugo_use
            </span>
            <span class="is-hidden-tablet">
              Hugo_use
            </span>
            
          </a>
        </p>
      </div>
    </div>

    <div class="level-right">
      <div class="level-item">
        <p class="control has-addons">
          <a class="button" href="https://hzlhy.github.io/ctf/buuctf_web_part0/">
            <span class="is-hidden-touch is-hidden-desktop-only">
              BUUCTF_WEB_part0
            </span>
            <span class="is-hidden-touch is-hidden-widescreen">
              BUUCTF_WEB_part0
            </span>
            <span class="is-hidden-mobile is-hidden-desktop">
              BUUCTF_WEB_part0
            </span>
            <span class="is-hidden-tablet">
              BUUCTF_WEB_part0
            </span>
            
            <span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
          </a>
        </p>
      </div>
    </div>

  </div>
</div>


      <br>

      
      

      <br>

      
      
<div class="container">
  <nav class="panel">
    <p class="panel-heading">Related</p>
    <a class="panel-block" href="https://hzlhy.github.io/ctf/buuctf_web_part0/">
      <span class="icon is-small"><i class="fas fa-chevron-right"></i></span>
      <span>&nbsp;</span>
      <span>BUUCTF_WEB_part0&nbsp;
      <div class="tag">B U U C T F W E B</div>
      </span>
    </a>
  </nav>
</div>

    </section>

    <footer class="footer">
  <div class="container">
    <nav class="level">

      <div class="level-item has-text-centered">
        <a href="https://hzlhy.github.io/about/" class="heading">
          <span class="header">Abouts</span>
        </a>
      </div><div class="level-item has-text-centered">
        <a href="https://hzlhy.github.io/ctf/" class="heading">
          <span class="header">CTFs</span>
        </a>
      </div>

    </nav>

    <nav class="level">

      <div class="level-left has-text-centered">
        <div class="level-item">
          <form class="control has-icons has-icons-right" method="get"
                action="https://duckduckgo.com">
            <input class="input" type="text" name="q" maxlength="255"
                   placeholder="Search">
            <input class="input" type="hidden" name="sites"
                   value="https://hzlhy.github.io/">
            <span class="icon is-small is-right"><i class="fas fa-search"></i></span>
          </form>
        </div>
      </div>

      <div class="level-right has-text-centered">
        <div class="level-item">

          <a class="button" href="/">
            <span class="icon"><i class="fas fa-home"></i></span>
          </a> &nbsp;

          

          <a class="button"
             href="">
            <span class="icon"><i class="fas fa-rss"></i></span>
          </a>

        </div>
      </div>

    </nav>
  </div>
</footer>

  </body>

</html>
